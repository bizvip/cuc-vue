import{a2 as o}from"./request-372f441e.js";import{M as C}from"./index-a1461b30.js";import{r as c,v as g,i as s,o as I,j as S,k as a,s as u,p as i,u as D}from"./runtime-core.esm-bundler-0dd628d9.js";const f={getPageList(t={}){return o({url:"setting/crontab/index",method:"get",params:t})},getLogPageList(t={}){return o({url:"setting/crontab/logPageList",method:"get",params:t})},deleteLog(t){return o({url:"setting/crontab/deleteCrontabLog",method:"delete",data:t})},run(t={}){return o({url:"setting/crontab/run",method:"post",data:t})},save(t={}){return o({url:"setting/crontab/save",method:"post",data:t})},deletes(t){return o({url:"setting/crontab/delete",method:"delete",data:t})},update(t,l={}){return o({url:"setting/crontab/update/"+t,method:"put",data:l})},changeStatus(t={}){return o({url:"setting/crontab/changeStatus",method:"put",data:t})}},P={__name:"logList",setup(t,{expose:l}){const p=c(),_=c(),d=c(!1),m=e=>{_.value=e,p.value.requestData(),d.value=!0},h=e=>{const r=e.exception_info;C.info({simple:!1,title:"异常信息",content:r==""?"无异常信息":r})},b=g({autoRequest:!1,api:f.getLogPageList,showIndex:!1,rowSelection:{showCheckedAll:!0},operationColumn:!0,operationWidth:100,delete:{show:!0,api:f.deleteLog,auth:["setting:crontab:deleteCrontabLog"]},beforeRequest:e=>{e.orderBy="created_at",e.orderType="desc",e.crontab_id=_.value}}),v=g([{title:"ID",dataIndex:"id",addDisplay:!1,editDisplay:!1,width:50,hide:!0},{title:"执行时间",dataIndex:"created_at",width:180},{title:"执行目标",dataIndex:"target",width:240},{title:"执行结果",dataIndex:"status",width:100},{title:"异常信息",dataIndex:"exception_info",width:100}]);return l({open:m}),(e,r)=>{const x=s("a-tag"),w=s("icon-eye"),L=s("a-link"),k=s("ma-crud"),y=s("a-drawer");return I(),S(y,{footer:!1,visible:d.value,"onUpdate:visible":r[0]||(r[0]=n=>d.value=n),width:"800px"},{title:a(()=>[u("执行日志")]),default:a(()=>[i(k,{options:b,columns:v,ref_key:"crudRef",ref:p},{status:a(({record:n})=>[i(x,{color:`${n.status==1?"green":"red"}`},{default:a(()=>[u(D(n.status==1?"成功":"失败"),1)]),_:2},1032,["color"])]),exception_info:a(({record:n})=>[i(L,{onClick:q=>h(n)},{default:a(()=>[i(w),u(" 查看")]),_:2},1032,["onClick"])]),_:1},8,["options","columns"])]),_:1},8,["visible"])}}},M=Object.freeze(Object.defineProperty({__proto__:null,default:P},Symbol.toStringTag,{value:"Module"}));export{P as _,f as c,M as l};
