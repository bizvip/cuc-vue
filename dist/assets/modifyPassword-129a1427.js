import{u as g}from"./user-73ea5d93.js";import{$ as f,a0 as V}from"./request-7ebe3d6d.js";import{v as y,r as c,i as n,o as k,c as U,p as l,k as s,s as i,F as q}from"./runtime-core.esm-bundler-0dd628d9.js";const N={__name:"modifyPassword",setup(C){const t=y({oldPassword:"",newPassword:"",newPassword_confirmation:""}),m=c(!1),a=c(0),p=()=>{window.location.href="/"},w=async o=>{if(!o.errors){if(o.values.newPassword!==o.values.newPassword_confirmation){f.error("确认密码与新密码不一致");return}const e=await g.modifyPassword(o.values);e.success?(V.local.clear(),m.value=!0):f.error(e.message)}},_=o=>{if(o.length<1){a.value=0;return}if(!(o.length>=6)){a.value=0;return}a.value=.1,/\d/.test(o)&&(a.value+=.1),/[a-z]/.test(o)&&(a.value+=.1),/[A-Z]/.test(o)&&(a.value+=.3),/[`~!@#$%^&*()_+<>?:"{},./;'[\]]/.test(o)&&(a.value+=.4)};return(o,e)=>{const d=n("a-input-password"),u=n("a-form-item"),v=n("a-progress"),P=n("a-button"),b=n("a-form"),x=n("a-modal");return k(),U(q,null,[l(b,{class:"w-full md:w-full mt-3",model:t,onSubmit:w},{default:s(()=>[l(u,{label:"旧密码",field:"oldPassword","label-col-flex":"80px",rules:[{required:!0,message:"旧密码必填"}]},{default:s(()=>[l(d,{modelValue:t.oldPassword,"onUpdate:modelValue":e[0]||(e[0]=r=>t.oldPassword=r),"allow-clear":"",autocomplete:"off"},null,8,["modelValue"])]),_:1}),l(u,{label:"新密码",field:"newPassword","label-col-flex":"80px",rules:[{required:!0,message:"新密码必填"}]},{default:s(()=>[l(d,{modelValue:t.newPassword,"onUpdate:modelValue":e[1]||(e[1]=r=>t.newPassword=r),onInput:_,onClear:e[2]||(e[2]=()=>a.value=0),autocomplete:"off","allow-clear":""},null,8,["modelValue"])]),_:1}),l(u,{label:"密码安全","label-col-flex":"80px"},{default:s(()=>[l(v,{steps:3,status:"success",percent:a.value,animation:"","show-text":!1},null,8,["percent"])]),_:1}),l(u,{label:"确认密码",field:"newPassword_confirmation","label-col-flex":"80px",rules:[{required:!0,message:"确认密码必填"}]},{default:s(()=>[l(d,{"allow-clear":"",modelValue:t.newPassword_confirmation,"onUpdate:modelValue":e[3]||(e[3]=r=>t.newPassword_confirmation=r),autocomplete:"off"},null,8,["modelValue"])]),_:1}),l(u,{"label-col-flex":"80px"},{default:s(()=>[l(P,{"html-type":"submit",type:"primary"},{default:s(()=>[i("保存")]),_:1})]),_:1})]),_:1},8,["model"]),l(x,{visible:m.value,"onUpdate:visible":e[4]||(e[4]=r=>m.value=r),onOk:p},{title:s(()=>[i("提示")]),default:s(()=>[i(" 密码已经修改成功，需要重新登录系统，点击确定跳转登录页面。 ")]),_:1},8,["visible"])],64)}}};export{N as default};
