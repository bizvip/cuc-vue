import{a2 as s,a1 as z,$ as P}from"./request-7ebe3d6d.js";import{a as R}from"./apiGroup-8df4b8e1.js";import{r as f,i as n,o as i,j as k,k as l,s as d,p as r,a as H,c as w,F as B,L as D,u as U}from"./runtime-core.esm-bundler-0dd628d9.js";const x={getList(e={}){return s({url:"system/app/index",method:"get",params:e})},getRecycleList(e={}){return s({url:"system/app/recycle",method:"get",params:e})},save(e={}){return s({url:"system/app/save",method:"post",data:e})},read(e={}){return s({url:"system/app/read",method:"post",data:e})},deletes(e){return s({url:"system/app/delete",method:"delete",data:e})},recoverys(e){return s({url:"system/app/recovery",method:"put",data:e})},realDeletes(e){return s({url:"system/app/realDelete",method:"delete",data:e})},update(e,y={}){return s({url:"system/app/update/"+e,method:"put",data:y})},getAppId(){return s({url:"system/app/getAppId",method:"get"})},getAppSecret(){return s({url:"system/app/getAppSecret",method:"get"})},bind(e,y={}){return s({url:"system/app/bind/"+e,method:"put",data:y})},getBindApiList(e={}){return s({url:"system/app/getApiList",method:"get",params:e})},changeStatus(e={}){return s({url:"system/app/changeStatus",method:"put",data:e})}},J={class:"w-full"},K={__name:"bind",setup(e,{expose:y}){const A=f(!1),L=f(!0),g=f(),m=f([]),u=f([]),p=f([]),I=async t=>{g.value=t,A.value=!0,await q(),await E(),L.value=!1},j=async t=>{const a=[];if(u.value.map(o=>a.push(...o)),g.value){const o=await x.bind(g.value,{apiIds:z.uniq(a)});if(o.success){P.success(o.message),t(!0);return}t(!1)}t(!1)},q=async()=>{const t=await R.getSelectList({getApiList:!0});m.value=t.data,m.value.forEach(a=>{u.value.push([]),p.value.push(!1)})},E=async()=>{const t=await x.getBindApiList({id:g.value});t.success&&t.data.length>0&&t.data.map(a=>{m.value.map((o,_)=>{o.apis.map(async b=>{b.id==a&&u.value[_].push(b.id)}),u.value[_].length==o.apis.length&&(p.value[_]=!0)})})},V=(t,a)=>{p.value[t]?a.map(o=>{u.value[t].push(o.id)}):u.value[t]=[]},G=()=>{m.value.map((t,a)=>{p.value[a]=!0,V(a,t.apis)})},N=()=>{m.value.map((t,a)=>{p.value[a]=!1,u.value[a]=[]})};return y({open:I}),(t,a)=>{const o=n("icon-select-all"),_=n("a-button"),b=n("icon-eraser"),C=n("a-space"),S=n("a-checkbox"),F=n("a-checkbox-group"),M=n("a-empty"),O=n("a-spin"),T=n("a-drawer");return i(),k(T,{visible:A.value,"onUpdate:visible":a[0]||(a[0]=v=>A.value=v),width:"800px","on-before-ok":j,"ok-text":"保存绑定"},{title:l(()=>[d("绑定接口")]),default:l(()=>[r(O,{loading:L.value,tip:"数据加载中...",class:"w-full h-full"},{default:l(()=>[H("div",J,[r(C,null,{default:l(()=>[r(_,{type:"primary",onClick:G},{icon:l(()=>[r(o)]),default:l(()=>[d("全选")]),_:1}),r(_,{type:"primary",onClick:N},{icon:l(()=>[r(b)]),default:l(()=>[d("清除")]),_:1})]),_:1}),(i(!0),w(B,null,D(m.value,(v,h)=>(i(),w("div",{key:h,class:"mt-5 p-3 rounded flex flex-col",style:{border:"1px solid var(--color-border-2)"}},[r(C,null,{default:l(()=>[d(U(v.name)+" ",1),r(S,{modelValue:p.value[h],"onUpdate:modelValue":c=>p.value[h]=c,onChange:c=>V(h,v.apis)},{default:l(()=>[d("全选")]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),_:2},1024),v.apis.length>0?(i(),k(F,{key:0,class:"mt-3",modelValue:u.value[h],"onUpdate:modelValue":c=>u.value[h]=c},{default:l(()=>[(i(!0),w(B,null,D(v.apis,(c,$)=>(i(),k(S,{key:$,value:c.id},{default:l(()=>[d(U(c.name),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])):(i(),k(M,{key:1},{default:l(()=>[d("暂无接口")]),_:1}))]))),128))])]),_:1},8,["loading"])]),_:1},8,["visible"])}}},Y=Object.freeze(Object.defineProperty({__proto__:null,default:K},Symbol.toStringTag,{value:"Module"}));export{K as _,x as a,Y as b};
